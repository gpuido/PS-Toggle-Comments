# dot-source in $profile and add keybindings:# $psise.PowerShellTabs.SelectedPowerShellTab.AddOnsMenu.Submenus.Add("Insert Comment", {Insert-Comment}, "Ctrl+Shift+C") | Out-Null
# $psise.PowerShellTabs.SelectedPowerShellTab.AddOnsMenu.Submenus.Add("Remove Comment", {Remove-Comment}, "Ctrl+Shift+X") | Out-Nullfunction Insert-Comment {    if ($psISE.CurrentFile.Editor.SelectedText -eq "") {        $selectedText = $psISE.CurrentFile.Editor.CaretLineText        $psISE.CurrentFile.Editor.SelectCaretLine()        $newText = "# " + $selectedText        $psISE.CurrentFile.Editor.InsertText($newText)        $psISE.CurrentFile.Editor.Select($psISE.CurrentFile.Editor.CaretLine, 1, $psISE.CurrentFile.Editor.CaretLine, 1)        return    }    $selectedText = $psISE.CurrentFile.Editor.SelectedText    $linesSelected = $selectedText.Split("`r").Count    if ($linesSelected -eq 1) {        $newText = "# " + $selectedText        $psISE.CurrentFile.Editor.InsertText($newText)    } else {        $newText = "<#`n" + $selectedText + "`n#>"        $psISE.CurrentFile.Editor.InsertText($newText)    }}function Remove-Comment {    if ($psISE.CurrentFile.Editor.SelectedText -eq "") {        $selectedText = $psISE.CurrentFile.Editor.CaretLineText        $psISE.CurrentFile.Editor.SelectCaretLine()        $newText = $selectedText.Replace("# ", "")        $psISE.CurrentFile.Editor.InsertText($newText)        $psISE.CurrentFile.Editor.Select($psISE.CurrentFile.Editor.CaretLine, 1, $psISE.CurrentFile.Editor.CaretLine, 1)        return    }    $selectedText = $psISE.CurrentFile.Editor.SelectedText    $linesSelected = $selectedText.Split("`r").Count    if ($linesSelected -eq 1) {        $newText = $selectedText.Replace("# ", "")        $psISE.CurrentFile.Editor.InsertText($newText)    } else {        $newText = $selectedText.Replace("<#", "")        $newText = $newText.Replace("#>", "")        $newText = $newText.Replace("`n", "")        $psISE.CurrentFile.Editor.InsertText($newText)    } }